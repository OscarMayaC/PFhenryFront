{"ast":null,"code":"import Node from '../core/Node.js';\nimport Object3DNode from '../accessors/Object3DNode.js';\nimport PositionNode from '../accessors/PositionNode.js';\nimport UniformNode from '../core/UniformNode.js';\nimport OperatorNode from '../math/OperatorNode.js';\nimport MathNode from '../math/MathNode.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { getDistanceAttenuation } from '../functions/BSDFs.js';\nimport { Color } from 'three';\nclass LightNode extends Node {\n  constructor() {\n    let light = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    super('vec3');\n    this.updateType = NodeUpdateType.Object;\n    this.light = light;\n    this._colorNode = new UniformNode(new Color());\n    this._lightCutoffDistanceNode = new UniformNode(0);\n    this._lightDecayExponentNode = new UniformNode(0);\n  }\n  getHash() {\n    return this.light.uuid;\n  }\n  update() {\n    this._colorNode.value.copy(this.light.color).multiplyScalar(this.light.intensity);\n    this._lightCutoffDistanceNode.value = this.light.distance;\n    this._lightDecayExponentNode.value = this.light.decay;\n  }\n  generate(builder) {\n    const lightPositionView = new Object3DNode(Object3DNode.VIEW_POSITION);\n    const positionView = new PositionNode(PositionNode.VIEW);\n    const lVector = new OperatorNode('-', lightPositionView, positionView);\n    const lightDirection = new MathNode(MathNode.NORMALIZE, lVector);\n    const lightDistance = new MathNode(MathNode.LENGTH, lVector);\n    const lightAttenuation = getDistanceAttenuation({\n      lightDistance,\n      cutoffDistance: this._lightCutoffDistanceNode,\n      decayExponent: this._lightDecayExponentNode\n    });\n    const lightColor = new OperatorNode('*', this._colorNode, lightAttenuation);\n    lightPositionView.object3d = this.light;\n    const lightingModelFunction = builder.context.lightingModel;\n    if (lightingModelFunction !== undefined) {\n      const directDiffuse = builder.context.directDiffuse;\n      const directSpecular = builder.context.directSpecular;\n      lightingModelFunction({\n        lightDirection,\n        lightColor,\n        directDiffuse,\n        directSpecular\n      }, builder);\n    }\n  }\n}\nexport default LightNode;","map":{"version":3,"names":["Node","Object3DNode","PositionNode","UniformNode","OperatorNode","MathNode","NodeUpdateType","getDistanceAttenuation","Color","LightNode","constructor","light","arguments","length","undefined","updateType","Object","_colorNode","_lightCutoffDistanceNode","_lightDecayExponentNode","getHash","uuid","update","value","copy","color","multiplyScalar","intensity","distance","decay","generate","builder","lightPositionView","VIEW_POSITION","positionView","VIEW","lVector","lightDirection","NORMALIZE","lightDistance","LENGTH","lightAttenuation","cutoffDistance","decayExponent","lightColor","object3d","lightingModelFunction","context","lightingModel","directDiffuse","directSpecular"],"sources":["/Users/rociopichardo/Desktop/PFhenryFront/node_modules/three-stdlib/nodes/lights/LightNode.js"],"sourcesContent":["import Node from '../core/Node.js';\nimport Object3DNode from '../accessors/Object3DNode.js';\nimport PositionNode from '../accessors/PositionNode.js';\nimport UniformNode from '../core/UniformNode.js';\nimport OperatorNode from '../math/OperatorNode.js';\nimport MathNode from '../math/MathNode.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { getDistanceAttenuation } from '../functions/BSDFs.js';\nimport { Color } from 'three';\n\nclass LightNode extends Node {\n  constructor(light = null) {\n    super('vec3');\n    this.updateType = NodeUpdateType.Object;\n    this.light = light;\n    this._colorNode = new UniformNode(new Color());\n    this._lightCutoffDistanceNode = new UniformNode(0);\n    this._lightDecayExponentNode = new UniformNode(0);\n  }\n\n  getHash() {\n    return this.light.uuid;\n  }\n\n  update() {\n    this._colorNode.value.copy(this.light.color).multiplyScalar(this.light.intensity);\n\n    this._lightCutoffDistanceNode.value = this.light.distance;\n    this._lightDecayExponentNode.value = this.light.decay;\n  }\n\n  generate(builder) {\n    const lightPositionView = new Object3DNode(Object3DNode.VIEW_POSITION);\n    const positionView = new PositionNode(PositionNode.VIEW);\n    const lVector = new OperatorNode('-', lightPositionView, positionView);\n    const lightDirection = new MathNode(MathNode.NORMALIZE, lVector);\n    const lightDistance = new MathNode(MathNode.LENGTH, lVector);\n    const lightAttenuation = getDistanceAttenuation({\n      lightDistance,\n      cutoffDistance: this._lightCutoffDistanceNode,\n      decayExponent: this._lightDecayExponentNode\n    });\n    const lightColor = new OperatorNode('*', this._colorNode, lightAttenuation);\n    lightPositionView.object3d = this.light;\n    const lightingModelFunction = builder.context.lightingModel;\n\n    if (lightingModelFunction !== undefined) {\n      const directDiffuse = builder.context.directDiffuse;\n      const directSpecular = builder.context.directSpecular;\n      lightingModelFunction({\n        lightDirection,\n        lightColor,\n        directDiffuse,\n        directSpecular\n      }, builder);\n    }\n  }\n\n}\n\nexport default LightNode;\n"],"mappings":"AAAA,OAAOA,IAAI,MAAM,iBAAiB;AAClC,OAAOC,YAAY,MAAM,8BAA8B;AACvD,OAAOC,YAAY,MAAM,8BAA8B;AACvD,OAAOC,WAAW,MAAM,wBAAwB;AAChD,OAAOC,YAAY,MAAM,yBAAyB;AAClD,OAAOC,QAAQ,MAAM,qBAAqB;AAC1C,SAASC,cAAc,QAAQ,sBAAsB;AACrD,SAASC,sBAAsB,QAAQ,uBAAuB;AAC9D,SAASC,KAAK,QAAQ,OAAO;AAE7B,MAAMC,SAAS,SAAST,IAAI,CAAC;EAC3BU,WAAWA,CAAA,EAAe;IAAA,IAAdC,KAAK,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,IAAI;IACtB,KAAK,CAAC,MAAM,CAAC;IACb,IAAI,CAACG,UAAU,GAAGT,cAAc,CAACU,MAAM;IACvC,IAAI,CAACL,KAAK,GAAGA,KAAK;IAClB,IAAI,CAACM,UAAU,GAAG,IAAId,WAAW,CAAC,IAAIK,KAAK,EAAE,CAAC;IAC9C,IAAI,CAACU,wBAAwB,GAAG,IAAIf,WAAW,CAAC,CAAC,CAAC;IAClD,IAAI,CAACgB,uBAAuB,GAAG,IAAIhB,WAAW,CAAC,CAAC,CAAC;EACnD;EAEAiB,OAAOA,CAAA,EAAG;IACR,OAAO,IAAI,CAACT,KAAK,CAACU,IAAI;EACxB;EAEAC,MAAMA,CAAA,EAAG;IACP,IAAI,CAACL,UAAU,CAACM,KAAK,CAACC,IAAI,CAAC,IAAI,CAACb,KAAK,CAACc,KAAK,CAAC,CAACC,cAAc,CAAC,IAAI,CAACf,KAAK,CAACgB,SAAS,CAAC;IAEjF,IAAI,CAACT,wBAAwB,CAACK,KAAK,GAAG,IAAI,CAACZ,KAAK,CAACiB,QAAQ;IACzD,IAAI,CAACT,uBAAuB,CAACI,KAAK,GAAG,IAAI,CAACZ,KAAK,CAACkB,KAAK;EACvD;EAEAC,QAAQA,CAACC,OAAO,EAAE;IAChB,MAAMC,iBAAiB,GAAG,IAAI/B,YAAY,CAACA,YAAY,CAACgC,aAAa,CAAC;IACtE,MAAMC,YAAY,GAAG,IAAIhC,YAAY,CAACA,YAAY,CAACiC,IAAI,CAAC;IACxD,MAAMC,OAAO,GAAG,IAAIhC,YAAY,CAAC,GAAG,EAAE4B,iBAAiB,EAAEE,YAAY,CAAC;IACtE,MAAMG,cAAc,GAAG,IAAIhC,QAAQ,CAACA,QAAQ,CAACiC,SAAS,EAAEF,OAAO,CAAC;IAChE,MAAMG,aAAa,GAAG,IAAIlC,QAAQ,CAACA,QAAQ,CAACmC,MAAM,EAAEJ,OAAO,CAAC;IAC5D,MAAMK,gBAAgB,GAAGlC,sBAAsB,CAAC;MAC9CgC,aAAa;MACbG,cAAc,EAAE,IAAI,CAACxB,wBAAwB;MAC7CyB,aAAa,EAAE,IAAI,CAACxB;IACtB,CAAC,CAAC;IACF,MAAMyB,UAAU,GAAG,IAAIxC,YAAY,CAAC,GAAG,EAAE,IAAI,CAACa,UAAU,EAAEwB,gBAAgB,CAAC;IAC3ET,iBAAiB,CAACa,QAAQ,GAAG,IAAI,CAAClC,KAAK;IACvC,MAAMmC,qBAAqB,GAAGf,OAAO,CAACgB,OAAO,CAACC,aAAa;IAE3D,IAAIF,qBAAqB,KAAKhC,SAAS,EAAE;MACvC,MAAMmC,aAAa,GAAGlB,OAAO,CAACgB,OAAO,CAACE,aAAa;MACnD,MAAMC,cAAc,GAAGnB,OAAO,CAACgB,OAAO,CAACG,cAAc;MACrDJ,qBAAqB,CAAC;QACpBT,cAAc;QACdO,UAAU;QACVK,aAAa;QACbC;MACF,CAAC,EAAEnB,OAAO,CAAC;IACb;EACF;AAEF;AAEA,eAAetB,SAAS"},"metadata":{},"sourceType":"module","externalDependencies":[]}